first 300 lines of code
